# FTIR_Processor# FTIR-Smoother——傅里叶变化光谱（FTIR）平滑及基线校正

## 安装要求

在运行程序前，请确保已安装以下 Python 包：
- numpy (pip install numpy)
- pandas (pip install pandas)
- matplotlib (pip install matplotlib) 
- scipy (pip install scipy)
- statsmodels (pip install statsmodels)
- pybaselines (pip install pybaselines)

## 功能简介

本程序是一个用于光谱数据处理的图形界面工具，主要包含三个功能模块：
- 平滑处理
- 基线校正
- 特征峰分析

## 使用说明

### 数据格式要求
- 输入文件必须是 CSV 格式
- CSV 文件至少包含两列数据：第一列为波数(cm^-1)，第二列为吸光度/透过率值
- 数据应按波数排序

### 平滑处理模块

支持以下平滑方法：
- Savitzky-Golay 滤波：适用于保持峰形状的平滑处理
- LOWESS（局部平滑）：适用于非线性趋势的平滑
- 移动平均：简单的数据平滑方法
- 高斯滤波：基于高斯函数的平滑处理
- 中值滤波：去除离群点效果好

操作步骤：
1. 点击"加载数据"导入 CSV 文件
2. 在"数据范围选择"中设置处理范围（可选）
3. 在"平滑法"中选择合适的平滑方法
4. 在"参数设置"中调整相应参数
5. 点击"执行平滑"进行处理
6. 可通过"导出数据"保存处理结果

### 基线校正模块

支持以下校正方法：
- Rubberband（推荐）：FTIR 光谱最常用的方法
- 修正多项式：适用于简单基线校正
- 自适应迭代多项式：适合非线性基线校正
- Whittaker-ASLS：适用于基线漂移校正
- 平滑样条：适用于复杂基线校正

操作步骤：
1. 选择数据源（原始数据或平滑后数据）
2. 选择校正方法
3. 设置相应参数
4. 点击"执行校正"
5. 可通过"导出数据"保存处理结果

### 特征峰分析模块

支持以下功能：
- 自动寻峰：根据设定的阈值和最小距离自动识别特征峰
- 峰位选择：可手动选择感兴趣的峰进行分析
- 峰参数分析：包括峰位置、峰高度（未校正和校正后）、峰面积等
- 范围分析：可设定分析范围进行局部峰分析
- 导出功能：可将峰列表导出为CSV文件

操作步骤：
1. 选择数据源（原始数据、平滑后数据或基线校正后数据）
2. 设置峰检测参数
   - 阈值：设定峰识别的最小高度
   - 最小距离：设定相邻峰之间的最小间隔
3. 点击"寻找峰"进行自动峰检测
4. 在峰列表中选择感兴趣的峰
5. 设置分析范围（可选）
   - 输入上限和下限波数
6. 点击"分析选中峰"查看详细参数
7. 可通过"导出峰列表"保存检测结果

注意事项：
- 建议在进行峰分析前先进行数据平滑和基线校正
- 阈值设置过低可能导致噪声被误识别为峰
- 最小距离设置过小可能导致单个峰被多次识别
- 分析范围的选择会影响峰面积的计算结果
- 选择不同的数据源可能会得到不同的峰检测结果

## 注意事项

### 数据处理
- 建议先进行平滑处理，再进行基线校正
- 处理大量数据时可能需要等待一段时间
- 可以随时切换原始数据和平滑后数据进行对比

### 参数设置
- Savitzky-Golay 的窗口长度必须为奇数
- 移动平均和中值滤波的窗口长度建议从小到大尝试
- LOWESS 的分数参数范围为 0-1，建议从 0.2 开始调整

### 图形操作
- 图形区域支持缩放、平移等操作
- 可使用工具栏保存图形
- 上下两个子图分别显示全谱图和局部放大图

### 数据导出
- 导出的 CSV 文件包含原始数据和处理后的数据
- 建议及时保存处理结果

## 常见问题

### 1. 程序无响应
- 检查数据量是否过大
- 检查参数设置是否合理
- 确保数据格式正确

### 2. 处理效果不理想
- 尝试调整参数
- 考虑更换处理方法
- 检查数据是否存在异常值
- 可以尝试先平滑再基线校正的组合方法

### 3. 峰检测不准确
- 检查阈值设置是否合适
- 调整最小距离参数
- 考虑先进行数据平滑和基线校正
- 确保选择了合适的数据源

### 4. 峰面积计算结果异常
- 检查分析范围设置是否合理
- 确保基线校正效果良好
- 避免分析范围过大或过小

如有其他问题或建议，请联系：sl-xiao@zjnu.cn